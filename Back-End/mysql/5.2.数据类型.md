# 数据类型

每个数据库里的表都由一个或多个列构成，在用CREATE TABLE语句创建表时，必须为它的每一个列定义一种数据类型。每种数据类型都有以下特点：
- 它可以表示何种类型的值。
- 这种类型的值要占用多少存储空间。
- 值的长度是固定的（即该类型的每个值都将占用同样数量的存储空间），还是可变是（不同的值会占用不同数量的存储空间）。
- MySQL会如何比较这种类型的值，如何对它进行排序。
- 是否可以对这种类型进行索引，如何索引。

数字类型：除BIT之外，其它的数据类型可以带有正负号，也可以不带正负号。

类型名称 | 含义
---- | ----
TINYINT | 非常小的整数，1B
SMALLINT | 小整数，2B
MEDIUMINT | 中等大小的整数，3B
INT | 标准的整数，4B
BIGINT | 大整数，8B
DECIMAL | 定点数，空间大小取决于M和D
FLOAT | 单精度浮点数，4B
DOUBLE | 双精度浮点数，8B
BIT | 位域值，空间大小取决于M


字符串：可以容纳任何内容，甚至能容纳那些用于表示图像和声音的二进制数据。

类型名称 | 含义
---- | ----
CHAR | 固定长度的非二进制（字符）字符串
VARCHAR | 可变长度的非二进制串
BINARY | 固定长度的二进制串
VARBINARY | 可变长度的二进制串
TINYBLOB | 非常小型的BLOB（二进制大对象）
BLOB | 小型BLOB
MEDIUMBLOB | 中型BLOB
LONGBLOB | 大型BLOB
TINYTEXT | 非常小型的非二进制串
TEXT | 小型非二进制串
MEDIUMTEXT | 中等大小的非二进制串
LONGTEXT | 大型非二进制串
ENUM | 枚举集合。每个列的取值将是这个枚举集合中的某一个元素
SET | 集合。每个列的取值可以为零个或者多个集合元素

时态类型：CC、YY、MM、DD、hh、mm和ss分别代表世纪、年、月、日、时、分和秒。

类型名称 | 含义
---- | ----
DATE | 日期值，格式为'CCYY-MM-DD'
TIME | 时间值，格式为'hh:mm:ss'
DATETIME | 日期加时间值，格式为'CCYY-MM-DD hh:mm:ss'
TIMESTAMP | 时间戳值，格式为'CCYY-MM-DD hh:mm:ss'
YEAR | 年份值，格式为CCYY或YY


## 表定义里的数据类型

创建表可以调用CREATE TABLE语句，并列出表中所有的列。每个列都有一个名字、一个类型，以及一些可选的类型属性或通用属性，列定义语法如下：

    col_name col_type [type_attrs] [general_attrs]

所允许的类型特有属性取决于具体的数据类型，例如只有数字类型才有的UNSIGNED和ZEROFILL属性或只有非二进制字符串类型才有的CHARACTER SET和COLLATE属性；而通用属性可用于任何一种数据类型，例如NULL或NOT NULL用来表明某列是否允许NULL值，或对大部分数据类型可以通过DEFAULT子句来定义列的默认值。

除了BLOB与TEXT类型、空间类型，或者具有AUTO\_INCREMENT属性的列以外，可以指定DEFAULT def\_value子句来表明：若在创建新行时没有显式指定某个值，那么该列将赋值为def\_value。除了TIMESTAMP列和DATETIME列有限制以外，这里的默认值def\_value必须是一个常量。

如果某个列定义没有显式包含DEFAULT子句，并且该列允许为NULL值，那么其默认值为NULL。否则若该列不允许为NULL值，并在定义里没有显式包含DEFAULT子句，那在往表里插入新行时，若没有为列指定具体值，那么：
- 若没有启用SQL的严格模式，该列将被设置为其数据类型的隐含默认值（0，'0000-00-00'，空串，ENUM的第一个元素或SET的空集等）。
- 若启用了SQL的严格模式，如果表是事务性的，将出错，语句会中止执行然后回滚；如果不是事务性的，会有一些具体的选择。


查看某个已有表的定义信息的几种命令：
````
mysql> SHOW CREATE TABLE table_name\G
mysql> SHOW FULL COLUMNS FROM table_name;
````

## 表达式计算和类型转换

表达式包含子项和运算符，并且经过计算可以产生具体值。子项可以包含值，如常数、函数调用、表列引用，以及标量子查询。绝大部分情况下，表达式都是出现在输出列的列表里，以及SELECT语句的WHERE子句里。

当两个操作数都是整数时，对于运算符+、-和*，整个运算过程所使用的是BIGINT（64位）整数值。如果两个操作数都是整数，且其中有一个是无符号数，那么结果也将是无符号数。对于除DIV以外的所有运算符，如果某个操作数是近似值，那么整个计算过程会遵循双精度浮点运算规则。对于字符串转换为数字的情形也是如此，因为字符串总是会被转换为双精度数。

只要某个值的类型与上下文所要求的类型不相符，MySQL就会根据操作的类型自动进行类型转换。发生类型转换的场合有以下几种：
- 把操作数转换成适合运算符计算的相应类型
- 把函数参数转换成函数所期望的类型
- 把某个值转换成适合于存储在列里的另一种类型

默认情况下，MySQL会尽量把值转换为表达式所需要的类型，而不是产生错误。根据具体上下文的不同，MySQL会让值在三种通用类别（即数字、字符串、日期/时间）之间进行转换。如果某个值在类型转换后，看起来并不像目标类型的合法值，那么这个转换就是失败的，最终得到的结果将为0。

在数据输入操作期间，为防止把非法值转换成最相近的合法值，可以启用严格模式，以便把此类问题当作错误报告出来。


## 选择数据类型

最为“通用”的数据类型是字符串类型，任何内容都可以保存在字符串中，因为数字和日期都可以表示成字符串形式。但是数据库对字符串的处理效率以及占用空间不总是好的，需要视运用场景而定。

1. 列要存放什么类型的值。一般来说，应该做简明的决定，即用数字类型列存储数字、用字符类型列存储字符串、用时态类型列存储日期和时间。如果数字带有小数，就选用DECIMAL或浮点类型，不用整数类型。

2. 所有值是否都在某个特定的区间内。这个需要与需求方研究，比如数字的取值范围，字符串的长度问题等，应该在满足的范围内尽量取最小存储空间。当读取较短的值时，所需的磁盘读写操作会更少，并且可以把更多的键值放入内存索引缓冲区里，进而快索引搜索的速度。如果某个字符串列用于表示某种固定集合的值，那可以考虑使用ENUM或SET，它们在内部都被表示为数字，高效而紧凑。